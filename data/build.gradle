apply plugin: 'com.android.library'
apply plugin: 'kotlin-android'
apply plugin: 'kotlin-kapt'
apply plugin: 'dagger.hilt.android.plugin'
apply plugin: 'com.squareup.sqldelight'

apply from: rootProject.file("buildscripts/android-defaults.gradle")

android {

    sourceSets {
        main.java.srcDirs += [
                'src/main/sqldelight', // sql files
        ]
    }

    packagingOptions {
        exclude 'META-INF/AL2.0'
        exclude 'META-INF/LGPL2.1'
        exclude 'META-INF/licenses/ASM'
        exclude 'win32-x86/attach_hotspot_windows.dll'
        exclude 'win32-x86-64/attach_hotspot_windows.dll'
    }

    testOptions {
        unitTests {
            includeAndroidResources = true
        }
    }

}

sqldelight {
    Database {
        dialect = "sqlite:3.24"
        // verifyMigrations = true todo enable
    }
}

dependencies {
    implementation project(':core')
    implementation project(':shared')
    implementation project(':shared-android')
    implementation project(':prefs-keys')
    implementation project(':localization')
    implementation project(':features:search:api')
    implementation project(':features:library:api')
    implementation project(':features:equalizer:api')

    implementation lib_core.coroutines
    implementation lib_core.coroutines_android

    implementation lib_core.hilt
    kapt lib_core.hilt_processor

    implementation lib_x.core
    implementation lib_x.preference

    implementation lib_utils.fuzzy
    implementation lib_network.gson
    implementation lib_network.retrofit
    implementation lib_network.retrofit_gson
    implementation lib_network.ok_http
    implementation lib_network.ok_http_interceptor

    implementation lib_data.sql_content_resolver

    implementation lib_data.sql_delight

    testImplementation project(':core:testing')
    testImplementation project(':data:testing')
    testImplementation lib_data.sql_delight_test

    // TODO delete
    androidTestImplementation "androidx.arch.core:core-testing:2.1.0"
}
